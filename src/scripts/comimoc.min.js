
/* Comimoc front-end with AngularJS  v1.0.0
(c) 2013 Jérôme Steunou https://github.com/JSteunou/comimoc-front-angularjs
License: BSD */
!function(a,b){a.constant("SimpleI18n",{en:{zoneTitle:{0:"No comments yet.",one:"1 comment so far.",other:"{} comments."},formTitle:"Add a comment:",formSubmit:"Submit"},fr:{zoneTitle:{0:"Pas encore de commentaires.",one:"1 commentaire.",other:"{} commentaires."},formTitle:"Ajouter un commentaire:",formSubmit:"Envoyer"}}),a.factory("Comments",["$resource","COMIMOC_CONFIG",function(a,c){var d=function(a){var c=b.fromJson(a);return c.comments};return a(c.RESOURCES_LOCATION+"/comments",{},{query:{method:"GET",isArray:!0,transformResponse:d}})}]),a.controller("CommentCtrl",["$scope","Comments","COMIMOC_CONFIG","SimpleI18n",function(a,b,c,d){var e=function(){var a=window.location.pathname;return c.ARGS&&(a+=window.location.search),c.HASH&&(a+=window.location.hash),a},f=function(){return c.WEBSITE||""},g=function(a){return a.when=new Date(a.when),a},h=c.LOCALE||"en";a.i18n=d[h],a.comments=b.query({website:f(),page:e()}),a.comments.$promise.then(function(a){a.forEach(function(a){a=g(a)})}),a.comment=new b,a.submit=function(c){c&&(a.comment.website=f(),a.comment.page=e(),a.comment.$save().then(function(c){delete a.error,a.comment=new b,a.comments.push(g(c))},function(b){a.error=b}))}}])}(angular.module("comimoc"),angular);